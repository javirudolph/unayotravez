Purrr density curves
================

This is one of the things I keep doing over and over again, but the code
just will not stay in my head! Perhaps there is a package already out
there, but if there is, I never found it.

**How to make many many density lines or curves in the same plot?**

My work with seed dispersal led me here. I needed to simulate thousands
of dispersal kernels, and then I wanted to see them. These kernels where
generated by following a density function, but their parameters where
different. As an example, you can look at [Figure
5](https://javirudolph.github.io/aracari/Ch1_movement_rates/Ch1_Figures.html)
in my dissertation’s first chapter.

Let’s say you want to plot the density of a normal distribution:

``` r
ggplot() +
  stat_function(fun = dnorm, args = list(mean = 0, sd = 1)) +
  lims(x = c(-5,5))
```

![](purrr_densities_files/figure-gfm/unnamed-chunk-1-1.png)<!-- -->

Now, we do many, but change their mean:

``` r
dnorm_means <- seq(-2,2, length.out = 10)

curves_diff_mean <- purrr::map(seq(1:10), function(y)
  stat_function(fun = dnorm, args = list(mean = dnorm_means[y], sd = 1)))

ggplot() +
  curves_diff_mean +
  lims(x = c(-5, 5))
```

![](purrr_densities_files/figure-gfm/unnamed-chunk-2-1.png)<!-- -->

Sometimes my outputs are in a data frame:

``` r
params_df <- data.frame(dnorm_means = dnorm_means,
                        dnorm_sds = seq(0, 1, length.out = 10),
                        curve_cols = rainbow(10))

# Create the curves:

colored_curves <- purrr::map(seq(1:10), function(y)
  stat_function(fun = dnorm, args = list(mean = params_df$dnorm_means[y], sd = params_df$dnorm_sds[y]), color = params_df$curve_cols[y]))
```

Put it all together:

``` r
ggplot() +
  colored_curves +
  lims(x = c(-5, 5))
```

![](purrr_densities_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->

Let’s break down the code for the curves:

``` r
colored_curves <- purrr::map(seq(1:10), function(y)
  stat_function(
    # First we tell which density function to use:
    fun = dnorm,
    # we give it a list with the parameters for the function
    args = list(mean = params_df$dnorm_means[y], sd = params_df$dnorm_sds[y]),
    # Here, I added giving a color to each curve
    color = params_df$curve_cols[y]))
```
